# 电网集团发票识别助手 — 开发计划

---

## 一、项目概述

### 1.1 项目目标
开发一款面向电网集团财务/行政人员的本地桌面工具，实现：
- 发票OCR自动识别（GLM-OCR本地部署，API保留用于测试）
- 多系统自动登录与填写（ERP、报销、税务系统）
- 本地发票台账管理
- 打包为Windows可执行程序

### 1.2 开发周期
**预计总工期：4周（20个工作日）**

---

## 二、开发阶段规划

### 第一阶段：项目初始化与基础架构（3天）

#### Day 1: 环境搭建
- [ ] 初始化Git仓库
- [ ] 创建项目目录结构
- [ ] 配置package.json和依赖
- [ ] 设置TypeScript配置
- [ ] 配置Vite构建工具
- [ ] 设置ESLint和Prettier

**关键产出：**
- 完整的项目骨架
- 可运行的Electron + Vue3基础应用
- 开发环境配置完成

#### Day 2-3: 核心框架搭建
- [ ] 实现Electron主进程基础架构
- [ ] 设置IPC通信机制
- [ ] 创建Vue路由和状态管理
- [ ] 设计并初始化SQLite数据库
- [ ] 实现基础的加密工具模块

**关键产出：**
- 主进程和渲染进程通信正常
- 数据库初始化和基础CRUD功能
- 基础UI框架搭建完成

### 第二阶段：OCR识别模块开发（4天）

#### Day 4-5: GLM-OCR本地部署
- [ ] 下载并集成GLM-OCR本地模型
- [ ] 实现本地模型推理引擎
- [ ] 设计发票字段数据结构
- [ ] 实现图片预处理功能
- [ ] 开发OCR结果解析器

#### Day 6-7: PaddleOCR备用方案
- [ ] 集成PaddleOCR本地引擎
- [ ] 实现离线识别逻辑
- [ ] 开发智能识别策略调度
- [ ] 实现识别结果缓存机制
- [ ] 保留API调用接口用于测试

**关键产出：**
- 完整的离线OCR识别功能
- 双引擎本地部署（GLM-OCR为主，PaddleOCR备用）
- 识别准确率测试报告

### 第三阶段：自动化填写模块（5天）

#### Day 8-9: 浏览器自动化基础
- [ ] 集成Playwright引擎
- [ ] 实现浏览器池管理
- [ ] 开发会话持久化功能
- [ ] 实现多系统登录管理器

#### Day 10-12: 系统填写脚本
- [ ] 开发ERP系统填写脚本
- [ ] 开发报销系统填写脚本
- [ ] 开发税务系统填写脚本
- [ ] 实现填写结果验证
- [ ] 添加截图留证功能

**关键产出：**
- 支持3大系统的自动登录
- 实现发票信息自动填写
- 完整的操作日志记录

### 第四阶段：前端界面开发（4天）

#### Day 13-14: 核心页面开发
- [ ] 发票扫描/上传页面
- [ ] 发票列表展示页面
- [ ] 发票详情编辑页面
- [ ] 自动填写控制台页面

#### Day 15-16: 辅助功能
- [ ] 系统设置页面
- [ ] 凭据管理界面
- [ ] 操作日志查看
- [ ] 数据导入导出功能

**关键产出：**
- 完整的用户界面
- 良好的用户体验
- 响应式设计适配

### 第五阶段：集成测试与优化（3天）

#### Day 17-18: 系统集成
- [ ] 端到端功能测试
- [ ] 性能优化
- [ ] 错误处理完善
- [ ] 安全性加固

#### Day 19: 打包部署
- [ ] 配置electron-builder
- [ ] 生成Windows安装包
- [ ] 制作便携版
- [ ] 编写用户手册

**关键产出：**
- 可执行的桌面程序
- 完整的测试报告
- 部署文档

### 第六阶段：验收与交付（1天）

#### Day 20: 项目验收
- [ ] 用户验收测试
- [ ] 问题修复
- [ ] 项目交付
- [ ] 培训材料准备

---

## 三、技术实现要点

### 3.1 关键技术决策

| 技术点 | 方案 | 说明 |
|--------|------|------|
| OCR识别 | GLM-OCR本地 | 专用OCR模型，API测试用 |
| 自动化 | Playwright无头浏览器 | 稳定性好，API友好 |
| 数据存储 | SQLite + better-sqlite3 | 轻量级，无需配置 |
| 安全加密 | Node.js crypto + AES-256-GCM | 保护用户凭据 |
| 打包方案 | electron-builder + NSIS | 支持安装包和便携版 |

### 3.2 开发规范

1. **代码规范**
   - 使用TypeScript严格模式
   - 遵循ESLint + Prettier规范
   - 所有函数必须有JSDoc注释

2. **Git工作流**
   - 主分支：main
   - 开发分支：dev
   - 功能分支：feature/xxx
   - 修复分支：fix/xxx

3. **测试要求**
   - 单元测试覆盖率 > 70%
   - 所有API接口必须有集成测试
   - 关键功能必须有E2E测试

### 3.3 风险控制

| 风险项 | 影响 | 应对措施 |
|--------|------|----------|
| OCR识别率低 | 高 | 优化提示词，人工校验 |
| 系统界面变更 | 中 | 配置化选择器，快速适配 |
| 网络环境限制 | 中 | 离线模式支持 |
| 安全审计 | 高 | 加密存储，操作留痕 |

---

## 四、里程碑与交付物

### 里程碑1：基础框架完成（Day 3）
- [ ] 可运行的Electron应用
- [ ] 基础UI框架
- [ ] 数据库初始化

### 里程碑2：OCR功能完成（Day 7）
- [ ] GLM-OCR本地部署
- [ ] API测试接口
- [ ] 识别准确率 > 90%

### 里程碑3：自动化功能完成（Day 12）
- [ ] 3大系统自动登录
- [ ] 发票自动填写
- [ ] 操作日志记录

### 里程碑4：UI开发完成（Day 16）
- [ ] 所有功能页面
- [ ] 用户交互优化
- [ ] 响应式适配

### 里程碑5：项目交付（Day 20）
- [ ] 可执行程序
- [ ] 用户手册
- [ ] 源码交付

---

## 五、资源需求

### 5.1 开发资源
- 开发人员：1人（全栈）
- 测试人员：1人（兼职）
- 项目经理：1人（兼职）

### 5.2 外部资源
- GLM-OCR API密钥
- 测试用发票样本（>50张）
- 集团测试系统账号

### 5.3 硬件要求
- 开发机器：Windows 10/11
- 内存：≥16GB
- 硬盘：≥500GB SSD

---

## 六、附录

### 6.1 项目目录结构
```
fapaio/
├── src/
│   ├── main/                 # Electron主进程
│   │   ├── index.ts         # 入口文件
│   │   ├── ipc/             # IPC通信
│   │   ├── ocr/             # OCR模块
│   │   ├── automation/      # 自动化模块
│   │   ├── db/              # 数据库
│   │   └── utils/           # 工具函数
│   ├── renderer/            # Vue前端
│   │   ├── views/           # 页面组件
│   │   ├── components/      # 通用组件
│   │   └── stores/          # 状态管理
│   ├── shared/              # 共享类型
│   └── resources/           # 静态资源
├── docs/                    # 文档
├── tests/                   # 测试
├── build/                   # 构建输出
└── dist/                    # 打包输出
```

### 6.2 关键依赖清单
```json
{
  "dependencies": {
    "electron": "^28.0.0",
    "vue": "^3.4.0",
    "element-plus": "^2.5.0",
    "playwright": "^1.41.0",
    "better-sqlite3": "^9.2.0",
    "axios": "^1.6.0",
    "crypto-js": "^4.2.0"
  },
  "devDependencies": {
    "vite": "^5.0.0",
    "typescript": "^5.3.0",
    "electron-builder": "^24.9.0",
    "@types/node": "^20.10.0",
    "eslint": "^8.56.0",
    "prettier": "^3.1.0"
  }
}
```

---

**制定人：** Claude
**制定日期：** 2026-02-20
**版本：** v1.0